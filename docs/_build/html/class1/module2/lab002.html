<!DOCTYPE html>
<head>
  
  <!--STAGING:-->
  <script src="https://assets.adobedtm.com/50164577268f481934e5d57dbfb78f929164cd0d/satelliteLib-ea775cfabef5fca8b04e9392f20c986c0724a7c3-staging.js"></script>
  <!--Production:-->
  <script src="https://assets.adobedtm.com/50164577268f481934e5d57dbfb78f929164cd0d/satelliteLib-ea775cfabef5fca8b04e9392f20c986c0724a7c3.js"></script>
    <title>2.2.2. Lab – Excuting the PUA Script</title>
  

  <meta charset="utf-8">
  <!-- Twitter Bootstrap viewport setting -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- F5 metadata -->
  <meta name="kb_doc_type" content="Manual"/>
  <meta name="kb_doc_type" content="User Guide"/>
  <meta name="title" content="2.2.2. Lab – Excuting the PUA Script"/>
  <meta name="product" content="Access 301: Ephemeral Authentication"/>
  <meta name="version" content=""/>
  <meta name="updated_date"  content="None"/>
  <meta name="archived" content="Archived documents excluded"/>

  
  
  
  <link href="https://cdn.f5.com/favicon.ico" rel="icon">
 
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script type="text"> jQuery.noConflict(true)</script>

</head>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>2.2.2. Lab – Excuting the PUA Script &#8212; Access 301: Ephemeral Authentication  documentation</title>
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/f5_agility_theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/f5.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/f5-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/21fb8a09c3.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2.2.3. Lab – Validating the PUA Script Installation" href="lab003.html" />
    <link rel="prev" title="2.2.1. Lab – Priviledge User Access (PUA) Requirements" href="lab001.html" />
  </head><body>
  <div id="clouddocs-header"></div>

    <div id="dismiss">
      <button type="button" class="btn btn-info navbar-btn site-hidden"><i class="fa fa-align-justify"></i></button>
    </div>
    <div id="sidebar" class="section-nav">
      <nav class="nav-sidebartoc">
        <h5>Access 301: Ephemeral Authentication  documentation </h5>
<div id="searchbox" role="search">
  <form class="search" action="../../search.html" method="get">
    <input type="text" class="search" name="q" placeholder=" Search..." />
    <button type="submit" class="btn btn-info navbar-btn"><i class="fa fa-search"></i></button>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        <hr>
        <h5>Current Page</h5>
        <span class="nav-sidebartoc">
            <ul>
<li><a class="reference internal" href="#">2.2.2. Lab – Excuting the PUA Script</a><ul>
<li><a class="reference internal" href="#task-running-installation-script">2.2.2.1. Task – Running Installation Script</a></li>
</ul>
</li>
</ul>

         </span>
        <hr>
        <h5>Site Contents</h5>
        <span class="nav-sidebartoc">
            <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">1. Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../class1.html">2. Class - Access 301: Ephemeral Authentication</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../module1/module1.html">2.1. Module – Implement APM C3D Enhancements</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="module2.html">2.2. Module – Implement Priviledge User Authentication</a></li>
</ul>
</li>
</ul>

        </span><!-- Use this file to add extra links to the bottom of the ToC sidebar -->
<hr>
  <span class="nav-sidebartoc">
 <!-- insert content here -->
  </span>
      </nav>
    </div>

  
  <div class="main active" id="content">
    <article class="docs-container site-article-inner">
            <nav class="site-breadcrumb-nav site-nav">
          <ul class="site-breadcrumb-list">
            <li class="breadcrumb-item"><button type="button" id="sidebarCollapse" class="btn btn-info navbar-btn site-hidden"><i class="fa fa-align-justify"></i></button>&#x20 <a href="/">Community Training Classes &amp; Labs</a> &gt; <a href="../../index.html">Access 301: Ephemeral Authentication </a> &gt; 2.2.2. Lab – Excuting the PUA Script</li>
          </ul>
      </nav>
      
      

    
  <div class="section" id="lab-excuting-the-pua-script">
<h1>2.2.2. Lab – Excuting the PUA Script<a class="headerlink" href="#lab-excuting-the-pua-script" title="Permalink to this headline">¶</a></h1>
<p><strong>Overview</strong></p>
<p>The ./build_pua.sh script will do a pre-flight check to ensure all the pre-requisites are met and will invoke a UCS backup by default before making any changes. If this script is run on a BIG-IP with a trial license, you must use the -s or –sanity option to prevent checking for licensing restrictions, this should only be done in a non-production environment as this may cause issues with production systems.</p>
<p>After each invocation, a log file will be left in /var/log called f5-pua-install-xxxx.log which will outline all the actions taken along with the result or any errors encountered. This log file may be requested by support or an F5 engineer to assist in any troubleshooting.</p>
<p><strong>Usage</strong></p>
<p>Invoking ./build_pua.sh with “-h” or “–help” will alert you to the potential options you may use to modify the behavior of the script. As of this document and version 1.1.3 the current options are:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Options</strong></th>
<th class="head"><strong>Descriptions</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>-h, --help</td>
<td>This Notice</td>
</tr>
<tr class="row-odd"><td>-s --sanity</td>
<td>Bypass santiy checks (license, BIG-IP status)</td>
</tr>
<tr class="row-even"><td>-u --update</td>
<td>Update existing installation</td>
</tr>
<tr class="row-odd"><td>-e --extract</td>
<td>Extract files to temp location and exit</td>
</tr>
<tr class="row-even"><td>-n --nobackup</td>
<td>Does not perform UCS backup</td>
</tr>
<tr class="row-odd"><td>-c --checkonly</td>
<td>Check installed versions against this package</td>
</tr>
<tr class="row-even"><td>-d --disabletest</td>
<td>Disable test user</td>
</tr>
<tr class="row-odd"><td>-f --forceupgrade</td>
<td>Force upgrade of packages from this archive</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This lab will automate the installation of the ./build_pua.sh script by creating a file called pua_config.sh and saving to the same directory as ./build_pua.sh.
The <strong>pua_config.sh</strong> file is located in the <strong>/var/tmp/pua</strong> directory</p>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> Sample unattended install script
<span class="gp">#</span> place this in the same directory as
<span class="gp">#</span> build_pua.sh to automatcailly install
<span class="gp">#</span>
<span class="gp">#</span> uncomment the lines below to use/customize
<span class="go"> noninteractive=true</span>
<span class="go"> radiusvip=10.1.20.104</span>
<span class="go"> ldapvip=10.1.20.104</span>
<span class="go"> ldapsvip=10.1.20.104</span>
<span class="go"> webtopvip=10.1.10.104</span>
<span class="go"> radiusconfig=y</span>
<span class="go"> sampleca=y</span>
<span class="go"> disabletest=true</span>
<span class="go"> nobackup=true</span>
</pre></div>
</div>
<p>Setting “noninteractive=true” option will perform a full unattended install if all the sample prompts above are provided and uncommented, otherwise the answers provided in pua_config.sh will be used as the defaults in a semi-interactive install method.</p>
<div class="section" id="task-running-installation-script">
<h2>2.2.2.1. Task – Running Installation Script<a class="headerlink" href="#task-running-installation-script" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Login to into the BIG-IP via SSH</p>
</li>
<li><p class="first">Change Directory to <strong>/var/tmp/pua</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> /var/tmp/pua
</pre></div>
</div>
<p><img alt="image01" src="../../_images/image0011.png" /></p>
</li>
<li><p class="first">Unzip the PUA Build Script</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>unzip build_pua-151-1.1.5-rc17.zip
</pre></div>
</div>
<p><img alt="image02" src="../../_images/image0021.png" /></p>
</li>
<li><p class="first">Verify the <strong>pua_config.sh</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cat pua_config.sh
</pre></div>
</div>
<p><img alt="image03" src="../../_images/image0031.png" /></p>
</li>
<li><p class="first">Run the PUA installation script <strong>./build_pua.sh</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./build_pua-151.sh
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">[admin@bigip1:Active:Standalone] pua #</span> ./build_pua-151.sh

<span class="go">/var/tmp/pua/build_pua-151.sh - v1.1.5-rc17 on BIG-IP v15.1.0</span>
<span class="go">Reading config from /var/tmp/pua/pua_config.sh...</span>

<span class="go">noninteractive is GO... Buckle up...</span>

<span class="go">Preparing environment... [OK]</span>

<span class="go">Changing to /tmp/pua.rILEoICRFw... [OK]</span>

<span class="go">Extracting archive... [OK]</span>

<span class="go">Checking License Entitlements for Privileged User Access... [OK]</span>

<span class="go">Adding ILX archive directory... [OK]</span>

<span class="go">Checking modules are provisioned.</span>

<span class="go">Checking apm... [OK]</span>

<span class="go">Checking ilx... [OK]</span>

<span class="go">SUCCESS: All modules provisioned.</span>

<span class="go">Checking for BIG-IP-ILX-WebSSH2-current.tgz... [OK]</span>

<span class="go">Hash check for BIG-IP-ILX-WebSSH2-current.tgz... [OK]</span>

<span class="go">Checking for BIG-IP-ILX-ephemeral_auth-151-current.tgz... [OK]</span>

<span class="go">Hash check for BIG-IP-ILX-ephemeral_auth-151-current.tgz... [OK]</span>

<span class="go">RADIUS = 10.1.20.104</span>

<span class="go">LDAP = 10.1.20.104</span>

<span class="go">LDAPS = 10.1.20.104</span>

<span class="go">Webtop = 10.1.10.104</span>
<span class="go">[OK]</span>
<span class="go">[OK]</span>
<span class="go">[OK]</span>
<span class="go">[OK]</span>
<span class="go">[OK]</span>
<span class="go">[OK]</span>

<span class="go">Checking for ca.pua.lab.cer... [OK]</span>

<span class="go">Hash check for ca.pua.lab.cer... [OK]</span>

<span class="go">Installing CA file ca.pua.lab.cer... [OK]</span>

<span class="go">Creating pua_webtop-clientssl profile with CA ca.pua.lab.cer... [OK]</span>

<span class="go">Creating ephemeral_config data group... [OK]</span>

<span class="go">Creating ephemeral_LDAP_Bypass data group... [OK]</span>

<span class="go">Creating ephemeral_RADIUS_Bypass data group... [OK]</span>

<span class="go">Creating ephemeral_radprox_host_groups data group... [OK]</span>

<span class="go">Creating ephemeral_radprox_radius_attributes data group... [OK]</span>

<span class="go">Creating ephemeral_radprox_radius_client data group... [OK]</span>

<span class="go">Creating WebSSH2 Workspace... [OK]</span>

<span class="go">Extracting BIG-IP-ILX-WebSSH2-current.tgz to /var/ilx/workspaces/Common... [OK]</span>

<span class="go">Copying WebSSH2 config.json.sample to config.json... [OK]</span>

<span class="go">Creating WebSSH2 Plugin... [OK]</span>

<span class="go">Importing APM sample profile ... [OK]</span>

<span class="go">Modifying pua Web Top Link... [OK]</span>

<span class="go">Applying pua APM Policy... [OK]</span>

<span class="go">Creating Ephemeral Authentication Workspace... [OK]</span>

<span class="go">Extracting BIG-IP-ILX-ephemeral_auth-151-current.tgz to /var/ilx/workspaces/Common... [OK]</span>

<span class="go">Modifying Ephemeral Authentication Workspace... [OK]</span>

<span class="go">Copying Ephemeral Auth config.json.sample to config.json... [OK]</span>

<span class="go">Creating Ephemeral Authentication Plugin... [OK]</span>

<span class="go">Creating RADIUS Proxy Service Virtual Server... [OK]</span>

<span class="go">Creating LDAP Proxy Service Virtual Server... [OK]</span>

<span class="go">Creating LDAP Proxy Service Virtual Server... [OK]</span>

<span class="go">Creating LDAPS (ssl) Proxy Service Virtual Server... [OK]</span>

<span class="go">Creating Webtop Virtual Server... [OK]</span>

<span class="go">Modifying BIG-IP for RADIUS authentication against itself... [OK]</span>

<span class="go">Saving config... [OK]</span>

<span class="go">You can test your new APM webtop now by browsing to:</span>

<span class="go">  https://10.1.10.104</span>

<span class="go">  username: &lt;any&gt;</span>
<span class="go">  password: &lt;any&gt;</span>

<span class="go">This will let anyone in with any policy. The next step after testing would be</span>
<span class="go">to add access control through AD, MFA, or some other method.</span>

<span class="go">If the RADIUS testing option was enabled, any username will log in using</span>
<span class="go">Ephemeral Authentication.</span>

<span class="go">Task complete.</span>

<span class="go">Now go build an APM policy for PUA!</span>

<span class="go">Cleaning up...</span>




<span class="go">/var/tmp/pua/build_pua-151.sh - v1.1.5-rc17 on BIG-IP v15.1.0</span>
<span class="go">[admin@bigip1:Active:Standalone]</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>



    
     <div class="row next-prev-btn-row">
       <div class="col-lg-12">
       
        <a href="lab001.html" title="2.2.1. Lab – Priviledge User Access (PUA) Requirements" accesskey="p" class="btn btn-primary pull-left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>
       
       
          <a href="lab003.html" title="2.2.3. Lab – Validating the PUA Script Installation" accesskey="n" class="btn btn-primary pull-right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>
       
     </div>
     </div>
    

    </article>
  </div>

</div>


  <div id="clouddocs-footer"></div>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="../../_static/js/bootstrap.min.js"></script>
  <script type="text/javascript">
    jQuery.noConflict(true)
  </script>
  <script src="../../_static/js/clouddocs.js"></script>
  </body>
</html>